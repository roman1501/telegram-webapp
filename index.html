<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Greek House Tapper</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
/* ===== Base / reset ===== */
:root{--main-green:#004d00;--accent-green:#43a047;--light-green:#66bb6a;--dark-green:#2e7d32;--card-bg:#f5f5f5;}
:where(html,body,*){box-sizing:border-box;user-select:none;-webkit-user-select:none}
body{font-family:'Segoe UI',sans-serif;margin:0;padding:0;display:flex;flex-direction:column;height:100vh;background:linear-gradient(to bottom,var(--main-green),#fff);animation:fadeIn 1s ease-in}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
@keyframes slideIn{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}

/* ===== Tapper visuals ===== */
.coin-fly{position:fixed;width:24px;height:24px;background:url("greenCoin.png") center/contain no-repeat;pointer-events:none;z-index:9999;animation:flyToCounter 1s ease-out forwards}
@keyframes flyToCounter{to{transform:translate(var(--dx),var(--dy)) scale(.3);opacity:0}}
.section-heading{position:relative;display:inline-block;margin-bottom:8px;padding:12px 20px;border-radius:20px;font-weight:700;color:#003300;background:linear-gradient(145deg,rgba(202,255,179,.85) 40%,rgba(202,255,179,.3) 80%,rgba(202,255,179,0) 100%);box-shadow:0 8px 16px rgba(0,0,0,.06);overflow:hidden}
.section-heading::before{content:"";position:absolute;inset:-30% auto auto -30%;width:160%;height:160%;border-radius:50%;background:conic-gradient(from 90deg,rgba(202,255,179,.12),rgba(202,255,179,.05),rgba(202,255,179,.1),rgba(202,255,179,.02),transparent,rgba(202,255,179,.08));opacity:.7;mix-blend-mode:soft-light;pointer-events:none}
.tap-coin{width:145px;height:145px;border-radius:50%;margin:16px auto 8px;cursor:pointer;display:block;background:transparent;border:0;padding:0;transition:transform .15s ease;-webkit-tap-highlight-color:transparent;touch-action:manipulation}
.tap-coin.rotated{transform:rotate(-5deg)}
.tap-coin img{display:block;width:100%;height:100%;object-fit:cover;border-radius:50%}
.tap-coin.active{transform:scale(1.05);filter:brightness(1.1)}
.plus-one{position:absolute;color:#fff;text-shadow:0 0 6px rgba(0,0,0,.4);font:700 24px/1 sans-serif;animation:floatUp .8s ease forwards;pointer-events:none;z-index:999;filter:drop-shadow(0 0 4px #000)}
@keyframes floatUp{from{opacity:1;transform:translateY(0)}to{opacity:0;transform:translateY(-40px)}}

/* ===== Layout / tabs ===== */
.tab-content{flex:1;padding:20px;display:none;text-align:center;overflow-y:auto;animation:slideIn .3s ease}
.tab-content.active{display:block}
.tab-bar{display:flex;height:60px;background:var(--main-green);border-top:2px solid var(--dark-green);box-shadow:0 -3px 10px rgba(0,0,0,.2)}
.tab-button{flex:1;font-size:18px;padding:10px;cursor:pointer;border:0;background:0;color:#fff;font-weight:700;transition:background .3s}
.tab-button:hover{background:rgba(255,255,255,.1)}
.tab-button.active{background:var(--light-green)}
.counter{margin-top:20px;font-size:24px;color:#000;animation:pulse 1s infinite alternate ease-in-out}
@keyframes pulse{from{transform:scale(1)}to{transform:scale(1.05)}}
.logo{width:100px;margin:10px auto;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.3)}
.gyros-img,.bonus-img{max-width:100%;margin-top:20px;border-radius:12px;box-shadow:0 4px 10px rgba(0,0,0,.2)}

/* ===== Cards (market/inventory) ===== */
.bonus-list{display:flex;flex-direction:column;gap:20px}
.bonus-card{background:var(--card-bg);border-radius:16px;padding:16px;box-shadow:0 4px 16px rgba(0,0,0,.15);text-align:left;transition:transform .2s;display:grid;grid-template-areas:"img" "title" "desc" "row";gap:10px}
.bonus-card:hover{transform:scale(1.02)}
.bonus-card img{grid-area:img;width:100%;aspect-ratio:16/9;object-fit:cover;border-radius:12px;margin:0}
.bonus-title{grid-area:title;margin:0 0 2px;font-size:18px;line-height:1.15;color:var(--dark-green);font-weight:700}
.bonus-description{grid-area:desc;margin:0;font-size:14px;color:#2f2f2f}
.bonus-price{font-size:16px;color:#000;font-weight:700;line-height:1;white-space:nowrap;margin:0}
.bonus-card.used{opacity:.6;filter:grayscale(60%)}

/* ===== Market row: "price" over "button" (left) + expiry badge (right) ===== */
#market-tab .bonus-row{grid-area:row;display:grid;grid-template-columns:1fr max-content;align-items:center;column-gap:14px;margin-top:6px;width:100%}
#market-tab .bonus-row>*{min-width:0}
#market-tab .bonus-left{display:flex;flex-direction:column;align-items:flex-start;gap:8px}
#market-tab .bonus-card button{align-self:flex-start;margin-left:0;padding:10px 14px;font-size:15px;border:0;border-radius:10px;background:var(--accent-green);color:#fff;cursor:pointer;white-space:nowrap;transition:background .3s,transform .1s}
#market-tab .bonus-card button:active{transform:scale(.96)}
#market-tab .expiry-label{padding:8px 12px;display:inline-flex;align-items:center;gap:6px;max-width:42vw;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:#e86b6b;font-weight:700;font-size:15px;background:#ffe9e9;border:1px solid #ffd2d2;padding:6px 10px;border-radius:999px;line-height:1;box-shadow:0 1px 6px rgba(232,107,107,.15)}
#market-tab .expiry-label .txt{overflow:hidden;text-overflow:ellipsis;min-width:0}
#market-tab .expiry-label .icon{flex:0 0 auto}
#market-tab .expiry-label.expired{color:#757575;background:#f4f4f4;border-color:#e7e7e7}
@media (max-width:330px){
  #market-tab .expiry-label{font-size:12px;padding:5px 8px;max-width:55vw}
  #market-tab .bonus-card button{padding:9px 12px;font-size:14px}
}

/* ===== Happy hour ===== */
#happyHourTimer{max-width:330px;margin:10px auto;text-align:center;padding:6px 12px;border-radius:16px;background:rgba(202,255,179,.35);font-weight:600;font-size:14px;line-height:1.4;overflow:hidden}

/* ===== Modals (confirm / daily reward / fortune) ===== */
#confirmModal,#dailyRewardModal,.fortune-modal{display:none;position:fixed;inset:0;z-index:999;justify-content:center;align-items:center}
#confirmModal{background:rgba(0,0,0,.6);animation:fadeIn .3s ease}
#confirmModal.active::before{content:"";position:fixed;inset:0;background:rgba(255,255,255,.05)}
#confirmModal .modal-box{background:#fff;padding:24px;border-radius:16px;max-width:90%;text-align:center;box-shadow:0 6px 18px rgba(0,0,0,.3);animation:slideIn .4s ease}
#confirmModal p{font-size:18px;color:#333}
#confirmActivate{background:var(--accent-green);color:#fff}
#cancelActivate{background:#ccc;color:#333}
#confirmModal button{padding:12px 24px;margin:10px 8px 0;border:0;border-radius:10px;font-size:16px;cursor:pointer}

#dailyRewardModal{background:rgba(0,0,0,.4)}
#dailyRewardBlur{position:fixed;inset:0;z-index:998;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);background:rgba(255,255,255,.05);opacity:0;pointer-events:none;transition:opacity .3s}
#dailyRewardBlur.active{opacity:1;pointer-events:auto}
.daily-reward-box{background:rgba(255,255,255,.15);border:1px solid rgba(255,255,255,.25);padding:32px 24px;border-radius:20px;max-width:90%;text-align:center;color:#fff;box-shadow:0 8px 24px rgba(0,0,0,.25);background-image:radial-gradient(circle at top left,rgba(202,255,179,.3),rgba(255,255,255,.05));animation:fadeInModal .3s ease-out}
@keyframes fadeInModal{from{transform:scale(.95);opacity:0}to{transform:scale(1);opacity:1}}
.daily-reward-box h3{font-size:22px;margin:0 0 10px;color:#eaffea;text-shadow:0 1px 2px rgba(0,0,0,.3)}
.daily-reward-box p{font-size:18px;margin:0 0 20px;text-shadow:0 1px 1px rgba(0,0,0,.25)}
.daily-reward-box button{padding:10px 24px;background:linear-gradient(to right,#66bb6a,#99d699);color:#fff;border:0;border-radius:12px;font:700 16px/1 sans-serif;cursor:pointer;transition:.2s;box-shadow:0 4px 12px rgba(0,0,0,.2)}
.daily-reward-box button:hover{background:linear-gradient(to right,#7ddc7d,#b4e8b4)}

.fortune-btn{position:fixed;top:32px;right:28px;z-index:100;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#000 60%,#1E1E1E 100%);border:0;border-radius:50%;box-shadow:0 2px 18px 2px #ffe06655;padding:14px;cursor:pointer;transition:box-shadow .2s,transform .12s}
.fortune-btn:hover{box-shadow:0 2px 26px 8px #ffe06677;transform:scale(1.10)}
.fortune-modal{z-index:2000;background:rgba(96,96,96,.10);backdrop-filter:blur(11px);-webkit-backdrop-filter:blur(11px);animation:fadeIn .33s}
.fortune-modal-content{position:relative;background:rgba(255,255,255,.78);border-radius:28px;padding:36px 24px 24px;max-width:95vw;max-height:90dvh;width:min(520px,95vw);box-shadow:0 6px 32px #00884a28,0 2px 18px #0002;text-align:center;animation:fortuneAppear .22s cubic-bezier(.18,.78,.61,1.09);border:1.5px solid #d3ffe2;display:flex;flex-direction:column;overflow:hidden}
@keyframes fortuneAppear{from{transform:scale(.97) translateY(28px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}
.fortune-close-btn{position:absolute;top:14px;right:18px;background:rgba(44,197,125,.12);border:0;font-size:26px;font-weight:900;color:#12ae62;cursor:pointer;border-radius:50%;width:36px;height:36px;box-shadow:0 4px 12px #0fc59013;display:flex;align-items:center;justify-content:center}

/* ===== Mini Caf√© ===== */
.welcome-block{display:flex;flex-direction:column;align-items:center}
.mini-cafe{display:flex;flex-direction:column;gap:12px;align-items:center;overflow:auto;padding:12px 12px 12px;min-height:0;scrollbar-gutter:stable}
.mini-cafe .order{font-weight:700;color:#0c6a3a;background:#eaffea;border:1px solid #c8f5d9;padding:8px 12px;border-radius:12px}
.mini-cafe .worktop{display:flex;gap:12px;align-items:flex-end;justify-content:center}
.ingredients{display:grid;grid-template-columns:repeat(4,minmax(62px,1fr));gap:10px}
.ingredient{background:#fff;border:1px solid #e3f7ea;border-radius:12px;padding:8px;cursor:pointer;box-shadow:0 2px 8px #0001;transition:transform .12s;font-size:12px}
.ingredient:hover{transform:translateY(-1px)}
.ingredient.used{opacity:.45;pointer-events:none}
.ingredient img{width:48px;height:48px;object-fit:cover;border-radius:10px;display:block;margin:0 auto 6px}
.ingredient.locked{opacity:.35;pointer-events:none;filter:grayscale(60%);cursor:not-allowed}
.plate-wrap{position:relative;width:250px;height:160px}
.plate{position:absolute;left:0;right:0;bottom:0;margin:auto;width:250px;height:90px;background:radial-gradient(ellipse at center,#fff 60%,#eee 100%);border:1px solid #e5e5e5;border-radius:0 0 120px 120px;box-shadow:0 6px 16px #0002 inset}
.on-plate{position:absolute;left:50%;bottom:35px;transform:translateX(-50%);display:flex;gap:8px;flex-wrap:wrap;justify-content:center;width:210px}
.badge-tip{font-size:12px;color:#3a3a3a;opacity:.8}
.fly{position:fixed;z-index:3000;width:48px;height:48px;pointer-events:none;transition:transform .45s cubic-bezier(.2,.8,.2,1),opacity .45s}
.success-msg{color:#0d8a54;font-weight:700;margin-top:6px}
.err-msg{color:#b00020;font-weight:600;margin-top:6px}
.hint-row{display:flex;gap:8px;justify-content:center;align-items:center}
.hint-toggle{background:transparent;border:1px dashed #c8f5d9;color:#0c6a3a;padding:4px 10px;border-radius:999px;font-size:12px;cursor:pointer}
.recipe-hint{display:none;gap:6px;flex-wrap:wrap;justify-content:center;padding:6px 8px;background:rgba(202,255,179,.22);border:1px solid #c8f5d9;border-radius:12px;margin-top:6px}
.recipe-hint.show{display:flex}
.step-chip{display:flex;align-items:center;gap:6px;background:#fff;border:1px solid #e3f7ea;border-radius:10px;padding:4px 8px;font-size:12px;white-space:nowrap}
.step-chip img{width:18px;height:18px;border-radius:4px}
.step-arrow{opacity:.55}
.mc-footer{position:static;display:flex;gap:8px;justify-content:center;background:rgba(255,255,255,.92);backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);padding:10px 12px;padding-bottom:calc(10px + env(safe-area-inset-bottom));border-top:1px solid #e8f5ee;border-radius:0 0 24px 24px}
.mc-btn{padding:10px 16px;border:0;border-radius:10px;font-weight:700;cursor:pointer}
#mcReset{background:#66bb6a;color:#fff} #mcClose{background:#e3e3e3;color:#333}
@media (max-width:600px){
  .mini-cafe .worktop{flex-direction:column;align-items:center;gap:8px}
  .plate-wrap{margin-top:-12px;width:200px;height:140px}
  .ingredients{grid-template-columns:repeat(2,minmax(80px,1fr));gap:14px}
  .plate{width:200px;height:80px;border-radius:0 0 100px 100px}
  .on-plate{width:170px;bottom:30px}
}
@media (max-width:380px){
  .ingredients{grid-template-columns:repeat(2,minmax(72px,1fr));gap:12px}
  .ingredient img{width:44px;height:44px}
}
/* –ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ –ø–æ–≤–Ω–µ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è, –≤–∏—Å–æ—Ç–∞ –∑–º—ñ–Ω–Ω–∞ –≤—ñ–¥ –æ—Ä–∏–≥—ñ–Ω–∞–ª—É */
#market-tab .bonus-card > img,
#inventory-tab .bonus-card > img,
.bonus-card > img{
  width: 100%;
  height: auto !important;      /* —Å–∫–∞—Å–æ–≤—É—î–º–æ —Ñ—ñ–∫—Å–æ–≤–∞–Ω—É –≤–∏—Å–æ—Ç—É */
  aspect-ratio: auto !important;/* —Å–∫–∞—Å–æ–≤—É—î–º–æ 16/9 */
  object-fit: contain;          /* –≥–∞—Ä–∞–Ω—Ç—ñ—è, —â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä—ñ–∂–µ */
  display: block;
  border-radius: 12px;
  margin: 0;
}
/* 1) –§—ñ–∫—Å –∫–ª—ñ–∫—ñ–≤ —É –º–æ–¥–∞–ª—Ü—ñ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è */
#confirmModal{ z-index: 2000; } /* –≤–∏—â–µ –∑–∞ —ñ–Ω—à—ñ */
#confirmModal::before{
  z-index: -1;            /* –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –∑–∞ –º–æ–¥–∞–ª–∫—É */
  pointer-events: none;   /* –Ω–∞ –≤—Å—è–∫: –Ω–µ –ø–µ—Ä–µ—Ö–æ–ø–ª—é—î –∫–ª—ñ–∫–∏ */
}
#confirmModal .modal-box{ position: relative; z-index: 1; }

/* 2) –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Å—Ç–∏–ª—ñ –∫–Ω–æ–ø–∫–∏ "–ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏" –≤ —ñ–Ω–≤–µ–Ω—Ç–∞—Ä—ñ */
#inventory-tab .bonus-card button{
  padding: 12px 20px;
  font-size: 16px;
  border-radius: 10px;
  background: var(--accent-green);
  color: #fff;
  border: 0;
  cursor: pointer;
  transition: transform .1s, background .3s;
}
#inventory-tab .bonus-card button:active{ transform: scale(.96); }

/* 3) –ù–∞ —Ä–∏–Ω–∫—É —Å—Ç–∏–ª—ñ —è–∫ –±—É–ª–æ: (–∑–∞–ª–∏—à–∞—î–º–æ –≤—É–∑—å–∫–µ –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –ø—ñ–¥ —Ü—ñ–Ω–æ—é) */
#market-tab .bonus-left{ align-items: flex-start; }
#market-tab .bonus-card button{ align-self: flex-start; }
/* –ö–Ω–æ–ø–∫–∞ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∞ (–±–æ–Ω—É—Å –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è) */
.bonus-card button.expired-btn,
.bonus-card button:disabled {
  background: #999 !important;
  color: #eee !important;
  opacity: 0.7;
  cursor: not-allowed;
  filter: grayscale(100%) brightness(0.9);
  transition: all 0.2s ease;
}

/* –ù–∞–ø—ñ–≤–ø—Ä–æ–∑–æ—Ä–∏–π hover ‚Äî –∑–∞–ª–∏—à–∞—î —á—ñ—Ç–∫–∏–π ‚Äú–∑–∞–±–æ—Ä–æ–Ω–µ–Ω–∏–π‚Äù –µ—Ñ–µ–∫—Ç */
.bonus-card button.expired-btn:hover,
.bonus-card button:disabled:hover {
  transform: none;
  filter: grayscale(100%) brightness(0.8);
  box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);
}

  </style>
</head>
<body>
<!-- <div id="blurOverlay"></div> -->
<div id="dailyRewardBlur"></div>

  <!-- –¢–∞–ø–∞—Ç–∏ -->
  <div id="tap-tab" class="tab-content active">
    <button id="fortuneBtn" class="fortune-btn" title="–ú—ñ–Ω—ñ-–∫–∞—Ñ–µ">
<!--   <img src="fortuneWheelIcon.png" alt="–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω–∏"> -->
</button>

<div class="welcome-block">
    <img src="logo.jfif" alt="Greek House logo" class="logo">
  <h2 class="section-heading">–ü—Ä–∏–≤—ñ—Ç, <span id="username">...</span>!</h2>
</div>
        <div class="counter" id="counter">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
    <div id="happyHourTimer" style="margin-top: 10px; font-size: 18px; color: #fff; background: #66bb6a; padding: 8px 16px; border-radius: 12px; display: none;">
  ‚è≥ Happy Hour —á–µ—Ä–µ–∑ ...
</div>
    <button class="tap-coin" id="tapBtn"><img src="greenCoin.png" alt="–ú–æ–Ω–µ—Ç–∫–∞ Greek House"></button>
    <img src="bg.jpg" alt="Gyros" class="gyros-img">
  </div>

<!-- –†–∏–Ω–æ–∫ -->
<div id="market-tab" class="tab-content">
  <h2 class="section-heading">üõí –†–∏–Ω–æ–∫ –±–æ–Ω—É—Å—ñ–≤</h2>
  <div class="bonus-list">
    <div class="bonus-card">
      <img src="gyros.jpeg" alt="-50% –Ω–∞ –≥—ñ—Ä–æ—Å">
      <div class="bonus-title">-50% –Ω–∞ –≥—ñ—Ä–æ—Å</div>
      <div class="bonus-description">–°–º–∞—á–Ω–∞ –∑–Ω–∏–∂–∫–∞ –Ω–∞ –≥—ñ—Ä–æ—Å —É Greek House</div>
      <div class="bonus-price">1000 –∫–ª—ñ–∫—ñ–≤</div>
      <button>–û—Ç—Ä–∏–º–∞—Ç–∏</button>
    </div>

    <div class="bonus-card">
      <img src="kartoplafrivelyka.jpeg" alt="–í–µ–ª–∏–∫–∞ –∫–∞—Ä—Ç–æ–ø–ª—è –∑–∞ 35 –≥—Ä–Ω">
      <div class="bonus-title">–í–µ–ª–∏–∫–∞ –∫–∞—Ä—Ç–æ–ø–ª—è –∑–∞ 35 –≥—Ä–Ω</div>
      <div class="bonus-description">–û–±–º—ñ–Ω—è–π –∫–ª—ñ–∫–∏ –Ω–∞ —Ö—Ä—É—Å—Ç–∫—É –∫–∞—Ä—Ç–æ–ø–ª—é!</div>
      <div class="bonus-price">700 –∫–ª—ñ–∫—ñ–≤</div>
      <button>–û—Ç—Ä–∏–º–∞—Ç–∏</button>
    </div>

    <div class="bonus-card">
      <img src="pitagrylichederini.png" alt="-50% –Ω–∞ –ø—ñ—Ç—É –≥—Ä–∏–ª—å –∑ —á–µ–¥–µ—Ä–æ–º">
      <div class="bonus-title">-50% –Ω–∞ –ø—ñ—Ç—É –≥—Ä–∏–ª—å –∑ —á–µ–¥–µ—Ä–æ–º</div>
      <div class="bonus-description">–°–∫—É—à—Ç—É–π —É–ª—é–±–ª–µ–Ω—É –ø—ñ—Ç—É –≤ 2 —Ä–∞–∑–∏ –¥–µ—à–µ–≤—à–µ!</div>
      <div class="bonus-price">750 –∫–ª—ñ–∫—ñ–≤</div>
      <button>–û—Ç—Ä–∏–º–∞—Ç–∏</button>
    </div>

    <div class="bonus-card">
      <img src="gyrosPlusRB.png" alt="Red Bull —É –ø–æ–¥–∞—Ä—É–Ω–æ–∫ –¥–æ –≥—ñ—Ä–æ—Å–∞">
      <div class="bonus-title">Red Bull –≤ –ø–æ–¥–∞—Ä—É–Ω–æ–∫ –¥–æ –≥—ñ—Ä–æ—Å–∞</div>
      <div class="bonus-description">–ë–µ—Ä–µ—à –≥—ñ—Ä–æ—Å? –ü—Ä–∏—Ö–æ–ø–∏ —ñ Red Bull –∑–∞ 0 –≥—Ä–Ω!</div>
      <div class="bonus-price">950 –∫–ª—ñ–∫—ñ–≤</div>
      <button>–û—Ç—Ä–∏–º–∞—Ç–∏</button>
    </div>
        <div class="bonus-card">
      <img src="kalmarPytaGyros.jpg" alt="-50% –Ω–∞ –ø—ñ—Ç—É –∞–±–æ –≥—ñ—Ä–æ—Å –∑ –∫–∞–ª—å–º–∞—Ä–æ–º">
      <div class="bonus-title">-50% –Ω–∞ –ø—ñ—Ç—É –∞–±–æ –≥—ñ—Ä–æ—Å –∑ –∫–∞–ª—å–º–∞—Ä–æ–º</div>
      <div class="bonus-description">240–≥—Ä–Ω - –∑–∞–¥–æ—Ä–æ–≥–æ? –¢–æ–¥—ñ —Ç—Ä–∏–º–∞–π —É–ª—é–±–ª–µ–Ω—É —Å—Ç—Ä–∞–≤—É –∑–∞ 120–≥—Ä–Ω!</div>
      <div class="bonus-price">850 –∫–ª—ñ–∫—ñ–≤</div>
      <button>–û—Ç—Ä–∏–º–∞—Ç–∏</button>
    </div>
        <div class="bonus-card">
      <img src="pytaTynez.jpg" alt="–ù–æ–≤–∞ –ø—ñ—Ç–∞ –∑ —Ç—É–Ω—Ü–µ–º –∑–∞ –ø—ñ–≤ —Ü—ñ–Ω–∏">
      <div class="bonus-title">–ù–æ–≤–∞ –ø—ñ—Ç–∞ –∑ —Ç—É–Ω—Ü–µ–º –∑–∞ –ø—ñ–≤ —Ü—ñ–Ω–∏</div>
      <div class="bonus-description">-50% –Ω–∞ –Ω–æ–≤–∏–Ω–∫—É, –ø—ñ—Ç—É –∑ —Ç—É–Ω—Ü–µ–º!</div>
      <div class="bonus-price">850 –∫–ª—ñ–∫—ñ–≤</div>
      <button>–û—Ç—Ä–∏–º–∞—Ç–∏</button>
    </div>
  </div>
</div>



  <!-- –Ü–Ω–≤–µ–Ω—Ç–∞—Ä -->
  <div id="inventory-tab" class="tab-content">
    <h2 class="section-heading">üéí –Ü–Ω–≤–µ–Ω—Ç–∞—Ä</h2>
    <div class="bonus-list"></div>
  </div>

  <!-- –ü–∞–Ω–µ–ª—å –≤–∫–ª–∞–¥–æ–∫ -->
  <div class="tab-bar">
    <button class="tab-button active" onclick="showTab('tap-tab', this)">–¢–∞–ø–∞—Ç–∏</button>
    <button class="tab-button" onclick="showTab('market-tab', this)">–†–∏–Ω–æ–∫</button>
    <button class="tab-button" onclick="showTab('inventory-tab', this)">–Ü–Ω–≤–µ–Ω—Ç–∞—Ä</button>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ -->
  <div id="confirmModal">
    <div class="modal-box">
      <p>–ü—ñ—Å–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó —Ü—å–æ–≥–æ –±–æ–Ω—É—Å—É –∑ º—è–≤–∏—Ç—å—Å—è –∫–æ–¥. –¶–µ–π –∫–æ–¥ –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –∑–∞—Å–∫—Ä—ñ–Ω–∏—Ç–∏ –∞–±–æ –≤—ñ–¥—Ä–∞–∑—É –ø–æ–∫–∞–∑–∞—Ç–∏ –Ω–∞ –∫–∞—Å—ñ. –Ü–Ω–∞–∫—à–µ, –≤–∏ –≤—Ç—Ä–∞—Ç–∏—Ç–µ —Ü–µ–π –∫–æ–¥ –Ω–∞–∑–∞–≤–∂–¥–∏.</p>
      <button id="confirmActivate">–ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏</button>
      <button id="cancelActivate">–ù–∞–∑–∞–¥</button>
    </div>
  </div>
  
<div id="dailyRewardModal">
  <div class="daily-reward-box">
    <h3>üéâ –©–æ–¥–µ–Ω–Ω–∞ –Ω–∞–≥–æ—Ä–æ–¥–∞</h3>
    <p>+100 –∫–ª—ñ–∫—ñ–≤ –∑–∞ –≤—Ö—ñ–¥ —Å—å–æ–≥–æ–¥–Ω—ñ!</p>
    <button onclick="closeDailyRewardModal()">–û–∫–µ–π</button>
  </div>
</div>
  <div id="fortuneModal" class="fortune-modal">
  <div class="fortune-modal-content">
<button id="closeFortuneModal" class="fortune-close-btn" title="–ó–∞–∫—Ä–∏—Ç–∏">‚úï</button>
<h3>–ú—ñ–Ω—ñ-–∫–∞—Ñ–µ: –∑–±–µ—Ä—ñ—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è</h3>

<div id="miniCafe" class="mini-cafe">
  <div class="order" id="mcOrder">–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è: –ì—ñ—Ä–æ—Å –∫–ª–∞—Å–∏—á–Ω–∏–π</div>
  <div class="hint-row">
  <button id="mcHintToggle" class="hint-toggle">–ü—ñ–¥–≥–ª—è–Ω—É—Ç–∏ —Ä–µ—Ü–µ–ø—Ç</button>
</div>
<div id="mcRecipeHint" class="recipe-hint"></div>


  <div class="worktop">
    <div class="ingredients" id="mcIngredients"></div>
    <div class="plate-wrap">
      <div class="plate"></div>
      <div class="on-plate" id="mcPlate"></div>
    </div>
  </div>

  <div class="badge-tip">–¢–∏—Ü—è–π —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç–∏ —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É üòâ</div>
  <div id="mcMsg"></div>
  </div>
  <div class="mc-footer">
  <button id="mcReset" class="mc-btn">–°–∫–∏–Ω—É—Ç–∏</button>
  <button id="mcClose" class="mc-btn">–ó–∞–∫—Ä–∏—Ç–∏</button>
</div>

</div>

  </div>
</div>
  <!-- –í–∏–±—ñ—Ä –≤–∞—Ä—ñ–∞–Ω—Ç—É –¥–ª—è –∫–∞–ª—å–º–∞—Ä–∞ -->
<div id="kalmarChoiceModal" style="display:none; position:fixed; inset:0; z-index:1500; background:rgba(0,0,0,.5); align-items:center; justify-content:center;">
  <div style="background:#fff; border-radius:16px; padding:20px; max-width:90%; text-align:center; box-shadow:0 6px 18px rgba(0,0,0,.3);">
    <h3 style="margin-top:0">–û–±–µ—Ä–∏ –≤–∞—Ä—ñ–∞–Ω—Ç –±–æ–Ω—É—Å—É</h3>
    <p style="margin:8px 0 16px">-50% –Ω–∞ –ø—ñ—Ç—É –∞–±–æ –≥—ñ—Ä–æ—Å –∑ –∫–∞–ª—å–º–∞—Ä–æ–º</p>
    <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
      <button id="btnKalmarPita" style="padding:10px 16px; border:none; border-radius:10px; background:#66bb6a; color:#fff; font-weight:700; cursor:pointer;">–ü—ñ—Ç–∞ –∑ –∫–∞–ª—å–º–∞—Ä–æ–º</button>
      <button id="btnKalmarGyros" style="padding:10px 16px; border:none; border-radius:10px; background:#66bb6a; color:#fff; font-weight:700; cursor:pointer;">–ì—ñ—Ä–æ—Å –∑ –∫–∞–ª—å–º–∞—Ä–æ–º</button>
      <button id="btnKalmarCancel" style="padding:10px 16px; border:none; border-radius:10px; background:#e3e3e3; color:#333; cursor:pointer;">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
  </div>
</div>

<script>
  
  const tg = window.Telegram.WebApp;
  
tg.ready();

// if (typeof tg.requestFullscreen === 'function') {
//   tg.requestFullscreen();
// } else {
//   console.warn('Fullscreen not supported, falling back to expand()');
//   tg.expand?.();
// }

// tg.onEvent('fullscreen_changed', event => {
//   console.log('Fullscreen state:', event.is_fullscreen);
// });

// tg.onEvent('fullscreen_failed', event => {
//   console.warn('Fullscreen failed:', event.error);
// });

  const supabaseUrl = 'https://mftgqxilushpzewpqkvi.supabase.co';
  const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1mdGdxeGlsdXNocHpld3Bxa3ZpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTEzMDQxMzMsImV4cCI6MjA2Njg4MDEzM30.qRsUDDHSFuP6hIQZwv0mVsfS-ZZDPPbDU5Zl55Hoezw';

  let user = tg.initDataUnsafe?.user || { id: 123456789, first_name: "–¢–µ—Å—Ç" };
  const userId = user.id;
  const userName = user.first_name || "–ì—ñ—Å—Ç—å";
  document.getElementById("username").innerText = userName;

  const counterEl = document.getElementById("counter");
  const inventoryListEl = document.querySelector("#inventory-tab .bonus-list");

  const confirmModal = document.getElementById("confirmModal");

  const confirmBtn = document.getElementById("confirmActivate");
  const cancelBtn = document.getElementById("cancelActivate");
  let isHappyHour = false;

    const happyHourStart = 21; // 17:00
const happyHourEnd = 22;   // 18:00
  // üëá –∑–∞–º—ñ–Ω–∏ –Ω–∞ —Å–≤—ñ–π —é–∑–µ—Ä–Ω–µ–π–º –±–æ—Ç–∞

  const availableBonuses = [
    {
      name: "gyros",
      title: "-50% –Ω–∞ –≥—ñ—Ä–æ—Å",
      description: "–°–º–∞—á–Ω–∞ –∑–Ω–∏–∂–∫–∞ –Ω–∞ –≥—ñ—Ä–æ—Å —É Greek House",
      price: 1000,
      image: "gyros.jpeg",
      expiresAt: "2025-10-10"
    },
    {
      name: "bigPotato",
      title: "–í–µ–ª–∏–∫–∞ –∫–∞—Ä—Ç–æ–ø–ª—è –∑–∞ 35 –≥—Ä–Ω",
      description: "–û–±–º—ñ–Ω—è–π –∫–ª—ñ–∫–∏ –Ω–∞ —Ö—Ä—É—Å—Ç–∫—É –∫–∞—Ä—Ç–æ–ø–ª—é!",
      price: 700,
      image: "kartoplafrivelyka.jpeg",
      expiresAt: "2025-10-10"
    },
    {
      name: "pitaGrylZChederom",
      title: "-50% –Ω–∞ –ø—ñ—Ç—É –≥—Ä–∏–ª—å –∑ —á–µ–¥–µ—Ä–æ–º",
      description: "–°–∫—É—à—Ç—É–π —É–ª—é–±–ª–µ–Ω—É –ø—ñ—Ç—É –≤ 2 —Ä–∞–∑–∏ –¥–µ—à–µ–≤—à–µ!",
      price: 750,
      image: "pitagrylichederini.png",
      expiresAt: "2025-10-01"
    },
    {
      name: "gyrosPlusRB",
      title: "Red Bull –≤ –ø–æ–¥–∞—Ä—É–Ω–æ–∫ –¥–æ –≥—ñ—Ä–æ—Å–∞",
      description: "–ë–µ—Ä–µ—à –≥—ñ—Ä–æ—Å? –ü—Ä–∏—Ö–æ–ø–∏ —ñ Red Bull –∑–∞ 0 –≥—Ä–Ω!",
      price: 950,
      image: "gyrosPlusRB.png",
      expiresAt: "2025-10-10"
    },
    {
      name: "kalmarPytaGyros",
      title: "-50% –Ω–∞ –ø—ñ—Ç—É –∞–±–æ –≥—ñ—Ä–æ—Å –∑ –∫–∞–ª—å–º–∞—Ä–æ–º",
      description: "240–≥—Ä–Ω - –∑–∞–¥–æ—Ä–æ–≥–æ? –¢–æ–¥—ñ —Ç—Ä–∏–º–∞–π —É–ª—é–±–ª–µ–Ω—É —Å—Ç—Ä–∞–≤—É –∑–∞ 120–≥—Ä–Ω!",
      price: 850,
      image: "kalmarPytaGyros.jpg",
      expiresAt: "2025-10-10"
    },
    {
      name: "pytaTynez",
      title: "–ù–æ–≤–∞ –ø—ñ—Ç–∞ –∑ —Ç—É–Ω—Ü–µ–º –∑–∞ –ø—ñ–≤ —Ü—ñ–Ω–∏",
      description: "-50% –Ω–∞ –Ω–æ–≤–∏–Ω–∫—É, –ø—ñ—Ç—É –∑ —Ç—É–Ω—Ü–µ–º!",
      price: 850,
      image: "pytaTynez.jpg",
      expiresAt: "2025-10-10"
    },
      {
    name: "kalmarPyta",
    title: "-50% –Ω–∞ –ø—ñ—Ç—É –∑ –∫–∞–ª—å–º–∞—Ä–æ–º",
    description: "–ü—ñ—Ç–∞ –∑ –∫–∞–ª—å–º–∞—Ä–æ–º –∑–∞ –ø—ñ–≤ —Ü—ñ–Ω–∏!",
    price: 850,
    image: "kalmarPytaGyros.jpg",
    expiresAt: "2025-10-10"
  },
  {
    name: "kalmarGyros",
    title: "-50% –Ω–∞ –≥—ñ—Ä–æ—Å –∑ –∫–∞–ª—å–º–∞—Ä–æ–º",
    description: "–ì—ñ—Ä–æ—Å –∑ –∫–∞–ª—å–º–∞—Ä–æ–º –∑–∞ –ø—ñ–≤ —Ü—ñ–Ω–∏!",
    price: 850,
    image: "kalmarPytaGyros.jpg",
    expiresAt: "2025-10-10"
  },
  ];
  
function getDaysLeft(expireDate) {
  const now = new Date();
  const end = new Date(expireDate);
  const diff = Math.ceil((end - now) / (1000 * 60 * 60 * 24));
  return diff > 0 ? diff : 0;
}
function pluralDaysUa(n) {
  const a = Math.abs(n) % 100, b = a % 10;
  if (a > 10 && a < 20) return '–¥–Ω—ñ–≤';
  if (b > 1 && b < 5) return '–¥–Ω—ñ';
  if (b === 1) return '–¥–µ–Ω—å';
  return '–¥–Ω—ñ–≤';
}



  let clicks = 0;

const happyEl = document.getElementById("happyHourTimer");
// function showBlur() {
//   const blur = document.getElementById("blurOverlay");
//   blur.style.opacity = "1";
// }

// function hideBlur() {
//   const blur = document.getElementById("blurOverlay");
//   blur.style.opacity = "0";
// }


  
function updateHappyHourTimer() {
  const now = new Date();
  const currentHour = now.getHours();
  const currentMinutes = now.getMinutes();
  const currentSeconds = now.getSeconds();

  const tapImg = document.querySelector("#tapBtn img");
  const tapBtn = document.getElementById("tapBtn");
  tapBtn.classList.add("rotated");
  if (currentHour >= happyHourStart && currentHour < happyHourEnd) {
    const minutesLeft = 59 - currentMinutes;
    const secondsLeft = 59 - currentSeconds;
    happyEl.innerText = `üéâ Happy Hour! +2 –∫–ª—ñ–∫–∏! –ó–∞–ª–∏—à–∏–ª–æ—Å—å: ${minutesLeft} —Ö–≤ ${secondsLeft} —Å–µ–∫`;
    happyEl.style.display = "block";
    isHappyHour = true;

    // üü° –ó–æ–ª–æ—Ç–∞ –º–æ–Ω–µ—Ç–∫–∞ + –≤–∏–¥–∞–ª–∏—Ç–∏ –Ω–∞—Ö–∏–ª
    if (tapImg.src.includes("greenCoin.png")) {
      tapImg.src = "goldCoin.png";
    }
    tapBtn.classList.remove("rotated");

  } else {
    const nextHappy = new Date();
    nextHappy.setHours(happyHourStart, 0, 0, 0);
    if (now >= nextHappy) nextHappy.setDate(nextHappy.getDate() + 1);
    const diffMs = nextHappy - now;
  const totalSeconds = Math.floor(diffMs / 1000);
const hours = Math.floor(totalSeconds / 3600);
const minutes = Math.floor((totalSeconds % 3600) / 60);
const seconds = totalSeconds % 60;

if (hours > 0) {
  happyEl.innerText = `‚è≥ Happy Hour —á–µ—Ä–µ–∑: ${hours} –≥–æ–¥ ${minutes} —Ö–≤`;
} else if (minutes > 0) {
  happyEl.innerText = `‚è≥ Happy Hour —á–µ—Ä–µ–∑: ${minutes} —Ö–≤`;
} else {
  happyEl.innerText = `‚è≥ Happy Hour –≤–∂–µ –∑–æ–≤—Å—ñ–º —Å–∫–æ—Ä–æ!`;
}


    happyEl.style.display = "block";
    isHappyHour = false;

    // üü¢ –ó–µ–ª–µ–Ω–∞ –º–æ–Ω–µ—Ç–∫–∞ + –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –Ω–∞—Ö–∏–ª
    if (tapImg.src.includes("goldCoin.png")) {
      tapImg.src = "greenCoin.png";
    }
    tapBtn.classList.add("rotated");
  }
}

function animateCoinRain(count = 100, reward = 100) {
  const counter = document.getElementById("counter");
  const counterRect = counter.getBoundingClientRect();
  let added = 0;

  for (let i = 0; i < count && added < reward; i++) {
    setTimeout(() => {
      // 1. –ú–æ–Ω–µ—Ç–∫–∞ –∑‚Äô—è–≤–ª—è—î—Ç—å—Å—è
      const coin = document.createElement("div");
      coin.classList.add("coin-fly");

      const startX = window.innerWidth / 2 + (Math.random() * 80 - 40);
      const startY = window.innerHeight / 2 + (Math.random() * 80 - 40);
      coin.style.left = `${startX}px`;
      coin.style.top = `${startY}px`;

      const dx = counterRect.left + counterRect.width / 2 - startX;
      const dy = counterRect.top + counterRect.height / 2 - startY;
      coin.style.setProperty("--dx", `${dx}px`);
      coin.style.setProperty("--dy", `${dy}px`);

      document.body.appendChild(coin);

      // 2. –ó–±—ñ–ª—å—à—É—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –ü–û 1
      clicks++;
      added++;
      updateDisplay();

      // 3. –ó–±–µ—Ä—ñ–≥–∞—î–º–æ, –∫–æ–ª–∏ –≤—Å—ñ –¥–æ–¥–∞–ª–∏—Å—è
      if (added === reward) {
        saveUserData();
      }

      // 4. –ú–æ–Ω–µ—Ç–∫–∞ –∑–Ω–∏–∫–∞—î —á–µ—Ä–µ–∑ 900–º—Å (–∞–Ω—ñ–º–∫–∞)
      setTimeout(() => coin.remove(), 900);
    }, i * 15); // –∑–∞—Ç—Ä–∏–º–∫–∞ –º—ñ–∂ –º–æ–Ω–µ—Ç–∫–∞–º–∏ (–º–æ–∂–µ—à –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞ —à–≤–∏–¥—à–µ —á–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ)
  }
}




setInterval(updateHappyHourTimer, 1000);

updateHappyHourTimer(); // –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –æ–¥—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ

const tapBtn = document.getElementById("tapBtn");

tapBtn.addEventListener("touchstart", () => {
  tapBtn.classList.add("active");
});
tapBtn.addEventListener("touchend", () => {
  tapBtn.classList.remove("active");
});
tapBtn.addEventListener("mousedown", () => {
  tapBtn.classList.add("active");
});
tapBtn.addEventListener("mouseup", () => {
  tapBtn.classList.remove("active");
});

async function checkDailyReward() {
  const today = new Date().toISOString().split('T')[0]; // YYYY-MM-DD

  const res = await fetch(`${supabaseUrl}/rest/v1/daily_rewards?user_id=eq.${userId}`, {
    headers: {
      apikey: supabaseKey,
      Authorization: `Bearer ${supabaseKey}`
    }
  });

  const data = await res.json();
  const lastRewardDate = data[0]?.last_claimed?.split('T')[0]; // –¢–µ–∂ –±–µ—Ä–µ–º–æ —Ç—ñ–ª—å–∫–∏ –¥–∞—Ç—É
  
  if (false) {
      // showBlur();
    // –î–æ–¥–∞—Ç–∏ +100 –∫–ª—ñ–∫—ñ–≤
    updateDisplay();
    await saveUserData();

    // –ü–æ–∫–∞–∑–∞—Ç–∏ –º–æ–¥–∞–ª–∫—É
    document.getElementById("dailyRewardModal").style.display = "flex";
    document.getElementById("dailyRewardBlur").classList.add("active");

    if (data.length === 0) {
      // –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Å
      await fetch(`${supabaseUrl}/rest/v1/daily_rewards`, {
        method: "POST",
        headers: {
          apikey: supabaseKey,
          Authorization: `Bearer ${supabaseKey}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ user_id: userId, last_claimed: today })
      });
    } else {
      // –û–Ω–æ–≤–∏—Ç–∏ –∑–∞–ø–∏—Å
      await fetch(`${supabaseUrl}/rest/v1/daily_rewards?user_id=eq.${userId}`, {
        method: "PATCH",
        headers: {
          apikey: supabaseKey,
          Authorization: `Bearer ${supabaseKey}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ last_claimed: today })
      });
    }
       // setTimeout(() => hideBlur(), 300);
  }
}






function closeDailyRewardModal() {
  document.getElementById("dailyRewardBlur").classList.remove("active");
  document.getElementById("dailyRewardModal").style.display = "none";

   animateCoinRain(100);
}

  async function fetchUserData() {
    const res = await fetch(`${supabaseUrl}/rest/v1/clicks?user_id=eq.${userId}`, {
      headers: { apikey: supabaseKey, Authorization: `Bearer ${supabaseKey}` }
    });
    const data = await res.json();
    if (data.length > 0) clicks = data[0].clicks;
    else {
      await fetch(`${supabaseUrl}/rest/v1/clicks`, {
        method: "POST",
        headers: {
          apikey: supabaseKey,
          Authorization: `Bearer ${supabaseKey}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ user_id: userId, clicks: 0 })
      });
    }
    updateDisplay();
    await checkDailyReward();
  }

  function updateDisplay() {
    counterEl.innerText = `–ö–ª—ñ–∫—ñ–≤: ${clicks}`;
  }

  async function saveUserData() {
    await fetch(`${supabaseUrl}/rest/v1/clicks?user_id=eq.${userId}`, {
      method: "PATCH",
      headers: {
        apikey: supabaseKey,
        Authorization: `Bearer ${supabaseKey}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ clicks })
    });
  }

  function generateRandomCode() {
    const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
    let code = 'GH-';
    for (let i = 0; i < 5; i++) {
      code += charset[Math.floor(Math.random() * charset.length)];
    }
    return code;
  }

  async function loadInventory() {
    const res = await fetch(`${supabaseUrl}/rest/v1/bonuses?user_id=eq.${userId}`, {
      headers: { apikey: supabaseKey, Authorization: `Bearer ${supabaseKey}` }
    });
    const bonuses = await res.json();

    bonuses.sort((a, b) => a.used - b.used); // –ì–æ—Ç–æ–≤—ñ —Å–ø–æ—á–∞—Ç–∫—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ ‚Äî –∑–Ω–∏–∑—É

    inventoryListEl.innerHTML = "";

    for (const bonus of bonuses) {
      const bonusData = availableBonuses.find(b => b.name === bonus.name);
      if (!bonusData) continue;

      const card = document.createElement("div");
      card.className = "bonus-card";
      if (bonus.used) card.classList.add("used");

      card.innerHTML = `
        <img src="${bonusData.image}" alt="${bonusData.title}">
        <div class="bonus-title">${bonusData.title}</div>
        <div class="bonus-description">${bonusData.description}</div>
        <div class="bonus-price">–°—Ç–∞—Ç—É—Å: <strong>${bonus.used ? "–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ" : "–ì–æ—Ç–æ–≤–∏–π –¥–æ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó"}</strong></div>
        ${!bonus.used ? '<button>–ê–∫—Ç–∏–≤—É–≤–∞—Ç–∏</button>' : ''}
      `;

      if (!bonus.used) {
        const btn = card.querySelector("button");
        btn.addEventListener("click", () => {
          confirmModal.classList.add("active");
confirmModal.style.display = "flex";


          const closeModal = () => {
            confirmModal.classList.remove("active");
confirmModal.style.display = "none";

            confirmBtn.onclick = null;
            cancelBtn.onclick = null;
          };

          cancelBtn.onclick = closeModal;

          confirmBtn.onclick = async () => {
            const code = generateRandomCode();

            const codeRes = await fetch(`${supabaseUrl}/rest/v1/discount_codes`, {
              method: "POST",
              headers: {
                apikey: supabaseKey,
                Authorization: `Bearer ${supabaseKey}`,
                "Content-Type": "application/json"
              },
              body: JSON.stringify({
                user_id: userId,
                code,
                used: false,
                bonus_name: bonusData.title
              })
            });

            const updateRes = await fetch(`${supabaseUrl}/rest/v1/bonuses?id=eq.${bonus.id}`, {
              method: "PATCH",
              headers: {
                apikey: supabaseKey,
                Authorization: `Bearer ${supabaseKey}`,
                "Content-Type": "application/json"
              },
              body: JSON.stringify({ used: true })
            });

            closeModal();

            if (codeRes.ok && updateRes.ok) {
              alert(`üéâ –í–∞—à –∫–æ–¥: ${code}`);
              loadInventory();
            } else {
              alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –±–æ–Ω—É—Å—É.");
            }
          };
        });
      }

      inventoryListEl.appendChild(card);
    }
  }

function showKalmarChoice(onPick) {
  const modal = document.getElementById('kalmarChoiceModal');
  const btnPita = document.getElementById('btnKalmarPita');
  const btnGyros = document.getElementById('btnKalmarGyros');
  const btnCancel = document.getElementById('btnKalmarCancel');

  const close = () => { modal.style.display = 'none';
    btnPita.onclick = btnGyros.onclick = btnCancel.onclick = null;
  };

  btnPita.onclick = () => { close(); onPick('pita'); };
  btnGyros.onclick = () => { close(); onPick('gyros'); };
  btnCancel.onclick = close;

  modal.style.display = 'flex';
}

async function purchaseBonus(bonusObj) {
  // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å—É
  if (clicks < bonusObj.price) {
    alert(`–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ –∫–ª—ñ–∫—ñ–≤. –ü–æ—Ç—Ä—ñ–±–Ω–æ ${bonusObj.price}`);
    return;
  }

  // –°–ø–∏—Å—É—î–º–æ —ñ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ
  clicks -= bonusObj.price;
  updateDisplay();
  await saveUserData();

  // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –±–æ–Ω—É—Å —É —Ç–∞–±–ª–∏—Ü—é 'bonuses'
  const res = await fetch(`${supabaseUrl}/rest/v1/bonuses`, {
    method: "POST",
    headers: {
      apikey: supabaseKey,
      Authorization: `Bearer ${supabaseKey}`,
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      user_id: userId,
      name: bonusObj.name,   // –≤–∞–∂–ª–∏–≤–æ: –∑–±–µ—Ä–µ–∂–µ—Ç—å—Å—è kalmarPyta –∞–±–æ kalmarGyros
      price: bonusObj.price,
      used: false
    })
  });

  if (res.ok) {
    alert(`üéÅ –í–∏ –æ—Ç—Ä–∏–º–∞–ª–∏ –±–æ–Ω—É—Å: ${bonusObj.title}`);
    loadInventory();
  } else {
    alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—ñ –±–æ–Ω—É—Å—É.");
  }
}

function setupMarketButtons() {
  const marketCards = document.querySelectorAll("#market-tab .bonus-card");

  marketCards.forEach((card, index) => {
    if (card.dataset.rowWired === "1") return;
    card.dataset.rowWired = "1";

    const btn = card.querySelector("button");
    const priceEl = card.querySelector(".bonus-price");
    const descEl = card.querySelector(".bonus-description");
    const bonus = availableBonuses[index];

    // –Ø–∫—â–æ price –Ω–µ–º–∞—î ‚Äî –ø—ñ–¥—Å—Ç—Ä–∞—Ö—É—î–º–æ—Å—å
    if (!priceEl) {
      const fallbackPrice = document.createElement("div");
      fallbackPrice.className = "bonus-price";
      fallbackPrice.textContent = `${bonus?.price ?? '-'} –∫–ª—ñ–∫—ñ–≤`;
      card.insertBefore(fallbackPrice, btn);
    }

    // –°—Ç–≤–æ—Ä—é—î–º–æ –±–µ–π–¥–∂ (—è–∫—â–æ —î –¥–µ–¥–ª–∞–π–Ω)
    let labelEl = null;
    if (bonus?.expiresAt) {
      const daysLeft = getDaysLeft(bonus.expiresAt);
      labelEl = document.createElement("span");
      labelEl.className = "expiry-label" + (daysLeft > 0 ? "" : " expired");
      labelEl.innerHTML = daysLeft > 0
        ? `<span class="icon">‚è∞</span><span class="txt">${daysLeft} ${pluralDaysUa(daysLeft)}</span>`
        : `<span class="icon">‚õî</span><span class="txt">–ó–∞–∫—ñ–Ω—á–∏–ª–∞—Å—å</span>`;
    }

    // –ù–û–í–ê —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
    // bonus-row: [ bonus-left | expiry-label ]
    // bonus-left: price (—Ä—è–¥–æ–∫ "** –∫–ª—ñ–∫—ñ–≤"), –Ω–∏–∂—á–µ ‚Äî –∫–Ω–æ–ø–∫–∞ "–û—Ç—Ä–∏–º–∞—Ç–∏"
    const row = document.createElement("div");
    row.className = "bonus-row";

    const leftCol = document.createElement("div");
    leftCol.className = "bonus-left";

    const priceNode = card.querySelector(".bonus-price"); // —ñ—Å–Ω—É—é—á–∏–π –≤—É–∑–æ–ª
    leftCol.appendChild(priceNode);
    leftCol.appendChild(btn);

    row.appendChild(leftCol);
    if (labelEl) row.appendChild(labelEl);

    // –í—Å—Ç–∞–≤–ª—è—î–º–æ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫ –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –æ–ø–∏—Å—É
    if (descEl && descEl.nextSibling) {
      card.insertBefore(row, descEl.nextSibling);
    } else {
      card.appendChild(row);
    }
// –Ø–∫—â–æ –±–æ–Ω—É—Å –ø—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–∏–π ‚Äî –±–ª–æ–∫—É—î–º–æ
if (bonus?.expiresAt && getDaysLeft(bonus.expiresAt) <= 0) {
  btn.disabled = true;
  btn.classList.add("expired-btn");
}

    // –ö–ª—ñ–∫ "–û—Ç—Ä–∏–º–∞—Ç–∏"
    btn.addEventListener("click", async () => {
      if (bonus.name === 'kalmarPytaGyros') {
        showKalmarChoice(async (variant) => {
          const chosen = variant === 'pita'
            ? availableBonuses.find(b => b.name === 'kalmarPyta')
            : availableBonuses.find(b => b.name === 'kalmarGyros');

          if (!chosen) {
            alert('–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ –æ–±—Ä–∞–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –±–æ–Ω—É—Å—É.');
            return;
          }
          await purchaseBonus(chosen);
        });
        return;
      }
      await purchaseBonus(bonus);
    });
  });
}

setInterval(() => {
  document.querySelectorAll("#market-tab .bonus-card").forEach((card, index) => {
    const bonus = availableBonuses[index];
    if (!bonus?.expiresAt) return;

    const label = card.querySelector(".expiry-label");
    if (!label) return;

    const d = getDaysLeft(bonus.expiresAt);
    label.classList.toggle("expired", d <= 0);
    label.innerHTML = d > 0 ? `‚è∞ ${d} ${pluralDaysUa(d)}` : `‚õî –ó–∞–∫—ñ–Ω—á–∏–ª–∞—Å—å`;
  });
}, 60 * 60 * 1000); // –æ–Ω–æ–≤–ª—é—î–º–æ —â–æ–≥–æ–¥–∏–Ω–∏




  
document.getElementById("tapBtn").addEventListener("click", (e) => {
Telegram.WebApp.HapticFeedback.impactOccurred('medium');


  const addAmount = isHappyHour ? 2 : 1;
  clicks += addAmount;
  updateDisplay();
  saveUserData();

  const plus = document.createElement("div");
  plus.className = "plus-one";
  plus.innerText = `+${addAmount}`;
  document.body.appendChild(plus);

  const rect = e.target.getBoundingClientRect();
  plus.style.left = rect.left + rect.width / 2 + "px";
  plus.style.top = rect.top + "px";

  setTimeout(() => {
    plus.remove();
  }, 800);
});


  function showTab(tabId, buttonEl) {
    document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));
    document.getElementById(tabId).classList.add("active");
    document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
    buttonEl.classList.add("active");
    if (tabId === "inventory-tab") loadInventory();
  }
const fortuneBtn = document.getElementById("fortuneBtn");
const fortuneModal = document.getElementById("fortuneModal");
const closeFortuneModal = document.getElementById("closeFortuneModal");

// –í—ñ–¥–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª–∫—É
fortuneBtn.addEventListener('click', () => {
  fortuneModal.style.display = 'flex';
  document.body.style.overflow = "hidden"; // –±–ª–æ–∫—É—î–º–æ –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω—É
});

// –ó–∞–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª–∫—É –∫–Ω–æ–ø–∫–æ—é
closeFortuneModal.addEventListener('click', () => {
  fortuneModal.style.display = 'none';
  document.body.style.overflow = ""; // –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø—Ä–æ–∫—Ä—É—Ç–∫—É
});

// –ó–∞–∫—Ä–∏—Ç–∏ –º–æ–¥–∞–ª–∫—É –∫–ª—ñ–∫–æ–º –ø–æ —Ñ–æ–Ω—É
fortuneModal.addEventListener('click', e => {
  if (e.target === fortuneModal) {
    fortuneModal.style.display = 'none';
    document.body.style.overflow = "";
  }
});
/* ===== Mini Caf√© logic ===== */
const mcIngredientsEl = document.getElementById('mcIngredients');
const mcPlateEl = document.getElementById('mcPlate');
const mcMsgEl = document.getElementById('mcMsg');
const mcOrderEl = document.getElementById('mcOrder');
const mcResetBtn = document.getElementById('mcReset');
const miniCafeEl = document.getElementById('miniCafe');

function scrollMiniCafeToBottom() {
  // —á–µ–∫–∞—î–º–æ, –ø–æ–∫–∏ DOM –æ–Ω–æ–≤–∏—Ç—å—Å—è (–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –≤–∂–µ –≤—Å—Ç–∞–≤–∏–ª–æ—Å—å)
  requestAnimationFrame(() => {
    const target = miniCafeEl.scrollHeight - miniCafeEl.clientHeight;

    // –ø—Ä–æ–±—É—î–º–æ –Ω–∞—Ç–∏–≤–Ω–∏–π smooth
    try {
      miniCafeEl.scrollTo({ top: target, behavior: 'smooth' });
    } catch (e) {
      // fallback: –º‚Äô—è–∫–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –≤—Ä—É—á–Ω—É
      const start = miniCafeEl.scrollTop;
      const dist = target - start;
      const dur = 350;
      let t0 = null;
      function step(ts) {
        if (!t0) t0 = ts;
        const p = Math.min((ts - t0) / dur, 1);
        const ease = 1 - Math.pow(1 - p, 3); // easeOutCubic
        miniCafeEl.scrollTop = start + dist * ease;
        if (p < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }
  });
}
  function scrollMiniCafeToBottomSafe() {
  scrollMiniCafeToBottom();          // –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  setTimeout(scrollMiniCafeToBottom, 520); // –≤–¥—Ä—É–≥–µ –ø—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —á—ñ–ø–∞
}


/** –ù–∞–±—ñ—Ä ¬´—Ä–µ—Ü–µ–ø—Ç—ñ–≤¬ª ‚Äî –º–æ–∂–Ω–∞ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏ */
const RECIPES = [
  {
    id: 'gyros',
    title: '–ì—ñ—Ä–æ—Å –∫–ª–∞—Å–∏—á–Ω–∏–π',
    rewardClicks: 50,
    steps: ['–ª–∞–≤–∞—à','–º º—è—Å–æ','–æ–≤–æ—á—ñ','—Å–æ—É—Å'],
  },
  {
    id: 'cheddarPita',
    title: '–ü—ñ—Ç–∞ –∑ —á–µ–¥–µ—Ä–æ–º',
    rewardClicks: 65,
    steps: ['–ø—ñ—Ç–∞','—Å–∏—Ä —á–µ–¥–µ—Ä','–æ–≤–æ—á—ñ','—Å–æ—É—Å'],
  }
];

/** –ü—É–ª —ñ–Ω–≥—Ä–µ–¥—ñ—î–Ω—Ç—ñ–≤ –∑ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º–∏ —ñ–∫–æ–Ω–∫–∞–º–∏ */
const ALL_ING = [
  { key:'–ª–∞–≤–∞—à', label:'–õ–∞–≤–∞—à', img:'lavash.png' },
  { key:'–º º—è—Å–æ', label:'–ú º—è—Å–æ', img:'meat.png' },
  { key:'–æ–≤–æ—á—ñ', label:'–û–≤–æ—á—ñ', img:'veggies.png' },
  { key:'—Å–æ—É—Å', label:'–°–æ—É—Å', img:'sauce.png' },
  { key:'–ø—ñ—Ç–∞', label:'–ü—ñ—Ç–∞', img:'pita.png' },
  { key:'—Å–∏—Ä —á–µ–¥–µ—Ä', label:'–ß–µ–¥–µ—Ä', img:'cheddar.png' },
];

let currentRecipe = null;
let progress = 0;

function pickRecipe() {
  // –æ–±–µ—Ä–µ–º–æ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ä–µ—Ü–µ–ø—Ç –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—ñ
  currentRecipe = RECIPES[Math.floor(Math.random()*RECIPES.length)];
  mcOrderEl.textContent = '–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è: ' + currentRecipe.title;
  progress = 0;
  mcMsgEl.innerHTML = '';
  renderIngredients();
  mcPlateEl.innerHTML = '';
  miniCafeEl.scrollTop = 0;
  renderRecipeHint();
mcRecipeHint.classList.remove('show');
mcHintToggle.textContent = '–ü—ñ–¥–≥–ª—è–Ω—É—Ç–∏ —Ä–µ—Ü–µ–ø—Ç';
}

function renderIngredients() {
  mcIngredientsEl.innerHTML = '';
  const poolKeys = new Set([...currentRecipe.steps]); // –ø–æ–∫–∞–∑—É—î–º–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ + –ø–∞—Ä—É –∑–∞–π–≤–∏—Ö, —â–æ–± –±—É–ª–æ —Ü—ñ–∫–∞–≤—ñ—à–µ
  // –¥–æ–¥–∞–º–æ 2 –±—É–¥—å-—è–∫—ñ –∑–∞–π–≤—ñ
  while (poolKeys.size < currentRecipe.steps.length + 2) {
    const extra = ALL_ING[Math.floor(Math.random()*ALL_ING.length)].key;
    poolKeys.add(extra);
  }

  // –∑—ñ–±—Ä–∞—Ç–∏ –æ–± º—î–∫—Ç–∏ —ñ —Ç—Ä–æ—Ö–∏ –ø–µ—Ä–µ–º—ñ—à–∞—Ç–∏
  const items = Array.from(poolKeys).map(k => ALL_ING.find(i => i.key===k)).filter(Boolean);
  items.sort(()=>Math.random()-.5);

  for (const ing of items) {
    const btn = document.createElement('button');
    btn.className = 'ingredient';
    btn.dataset.key = ing.key;
    btn.innerHTML = `<img src="${ing.img}" alt="${ing.label}"><div>${ing.label}</div>`;
    btn.addEventListener('click', () => onIngredientClick(btn, ing));
    mcIngredientsEl.appendChild(btn);
  }
}
function lockNonRecipeIngredients() {
  const allowed = new Set(currentRecipe.steps);
  mcIngredientsEl.querySelectorAll('.ingredient').forEach(btn => {
    if (!allowed.has(btn.dataset.key)) {
      btn.classList.add('locked');
      btn.disabled = true; 
      btn.setAttribute('aria-disabled','true');
      btn.setAttribute('tabindex','-1');
    }
  });
}

function onIngredientClick(btn, ing) {
  // —è–∫—â–æ —Ä–µ—Ü–µ–ø—Ç —É–∂–µ –∑—ñ–±—Ä–∞–Ω–∏–π ‚Äì —ñ–≥–Ω–æ—Ä—É—î–º–æ –±—É–¥—å-—è–∫—ñ –∫–ª—ñ–∫–∏
  if (!currentRecipe || progress >= currentRecipe.steps.length) return;

  const needed = currentRecipe.steps[progress];
  if (ing.key === needed) {
    btn.classList.add('used');
    flyToPlate(btn, ing);
    progress++;
    mcMsgEl.innerHTML = `<div class="success-msg">–î–æ–±—Ä–µ! ${progress}/${currentRecipe.steps.length}</div>`;
    Telegram.WebApp.HapticFeedback.impactOccurred('light');

    if (progress === currentRecipe.steps.length) {
      onRecipeComplete();
    }
  } else {
    mcMsgEl.innerHTML = `<div class="err-msg">–ü–æ—Å–ø—ñ—à–∏–≤ üòÖ. –°–ø–æ—á–∞—Ç–∫—É: <b>${needed}</b></div>`;
    Telegram.WebApp.HapticFeedback.notificationOccurred('warning');
    mcRecipeHint.classList.add('show');
    mcHintToggle.textContent = '–°—Ö–æ–≤–∞—Ç–∏ —Ä–µ—Ü–µ–ø—Ç';
    mcRecipeHint.scrollIntoView({ block:'nearest', behavior:'smooth' });
  }
}

async function onRecipeComplete() {
  const reward = currentRecipe.rewardClicks;
  clicks += reward;
  updateDisplay();
  await saveUserData();

  mcMsgEl.innerHTML = `<div class="success-msg">üéâ –ì–æ—Ç–æ–≤–æ! +${reward} –∫–ª—ñ–∫—ñ–≤ –∑–∞ ¬´${currentRecipe.title}¬ª</div>`;
  scrollMiniCafeToBottomSafe();
  Telegram.WebApp.HapticFeedback.notificationOccurred('success');

  // –ø—ñ—Å–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è ‚Äî –∑–∞–±–ª–æ–∫—É—î–º–æ –≤—Å–µ, —á–æ–≥–æ –Ω–µ –±—É–ª–æ –≤ —Ä–µ—Ü–µ–ø—Ç—ñ
  lockNonRecipeIngredients();
}


function flyToPlate(btn, ing) {
  const rect = btn.getBoundingClientRect();
  const plateRect = mcPlateEl.getBoundingClientRect();

  const ghost = document.createElement('img');
  ghost.src = ALL_ING.find(i=>i.key===ing.key)?.img || '';
  ghost.className = 'fly';
  ghost.style.left = rect.left + 'px';
  ghost.style.top  = rect.top + 'px';
  document.body.appendChild(ghost);

  requestAnimationFrame(() => {
    const dx = plateRect.left + plateRect.width/2 - rect.left - 24;
    const dy = plateRect.top + plateRect.height/2 - rect.top  - 24;
    ghost.style.transform = `translate(${dx}px, ${dy}px) scale(.6)`;
    ghost.style.opacity = '0.1';
  });

  setTimeout(() => {
    ghost.remove();
    const chip = document.createElement('img');
    chip.src = ALL_ING.find(i=>i.key===ing.key)?.img || '';
    chip.style.width = '36px';
    chip.style.height = '36px';
    chip.style.borderRadius = '8px';
    mcPlateEl.appendChild(chip);
  }, 460);
}

mcResetBtn.addEventListener('click', () => {
  pickRecipe();
});
const mcCloseBtn = document.getElementById('mcClose');
mcCloseBtn.addEventListener('click', () => {
  fortuneModal.style.display = 'none';
  document.body.style.overflow = "";
});
  
/** –ö–æ–ª–∏ –≤—ñ–¥–∫—Ä–∏–≤–∞—î—Ç—å—Å—è —Ç–≤–æ—è –º–æ–¥–∞–ª–∫–∞ ‚Äî —Å—Ç–∞—Ä—Ç—É—î–º–æ –≥—Ä—É */
fortuneBtn.addEventListener('click', () => {
  pickRecipe();
});
  const mcHintToggle = document.getElementById('mcHintToggle');
const mcRecipeHint = document.getElementById('mcRecipeHint');

function renderRecipeHint(){
  const parts = currentRecipe.steps.map(step=>{
    const ing = ALL_ING.find(i=>i.key===step);
    return `<span class="step-chip">${ing?.img ? `<img src="${ing.img}" alt="">` : ''}<span>${ing?.label || step}</span></span>`;
  });
  mcRecipeHint.innerHTML = parts.join('<span class="step-arrow">‚Üí</span>');
}

mcHintToggle.addEventListener('click', ()=>{
  const show = !mcRecipeHint.classList.contains('show');
  mcRecipeHint.classList.toggle('show', show);
  mcHintToggle.textContent = show ? '–°—Ö–æ–≤–∞—Ç–∏ —Ä–µ—Ü–µ–ø—Ç' : '–ü—ñ–¥–≥–ª—è–Ω—É—Ç–∏ —Ä–µ—Ü–µ–ø—Ç';
  if (show) mcRecipeHint.scrollIntoView({ block:'nearest', behavior:'smooth' });
});


fetchUserData().then(async () => {
  setupMarketButtons();
  loadInventory();
});
</script>


</body>
</html>


  




























































